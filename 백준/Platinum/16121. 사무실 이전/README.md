# [Platinum I] 사무실 이전 - 16121 

[문제 링크](https://www.acmicpc.net/problem/16121) 

### 성능 요약

메모리: 76840 KB, 시간: 1916 ms

### 분류

센트로이드, 센트로이드 분할, 분할 정복, 다이나믹 프로그래밍, 트리에서의 다이나믹 프로그래밍, 트리

### 제출 일자

2025년 3월 7일 05:59:49

### 문제 설명

<p>SNUPC(SNU Printing Company)는 서울대학교 컴퓨터공학부 학생들의 자료 인쇄를 책임지는 대기업이다. 최근 SNUPC의 사장 ntopia는 사무실이 301동에 있어 출근이 불편하다는 사원들의 의견을 받아들여 사무실을 지하철역 주변으로 옮기기로 했다.</p>

<p>서울 지하철에는 <em>N</em>개의 역이 있고, SNUPC의 직원들은 그 중 서로 다른 <em>M</em>개의 역 근처에 한 명씩 살고 있다. 지하철의 모든 역은 트리 구조로 연결되어 있어, 임의의 역에서 출발해 다른 모든 역으로 가는 경로가 유일하게 존재한다. 또한 모든 인접한 역 사이의 거리는 1로 같다. 직원들은 출근 경로의 거리의 제곱에 비례하여 스트레스를 받기 때문에, 출근 경로의 길이가 어떻게 바뀔지는 중요한 정보이다.</p>

<p>ntopia는 <em>K</em>개의 역 중 한 곳으로 사무실을 옮기기로 했으나, 오랜 시간 동안 결정을 하지 못했다. 그래서 ntopia는 대신 모든 후보에 대해 전 직원이 출근하는 경로의 길이의 제곱의 평균을 계산해서 미리 공지해 주기로 했다.</p>

<p>가능한 모든 사무실 후보에 대해 모든 직원의 출근 경로의 길이의 제곱을 모두 합한 값을 구하여라. 모든 직원은 가능한 가장 짧은 경로로 출근한다.</p>

### 입력 

 <p>첫 번째 줄에 지하철역의 개수 <em>N</em>(1 ≤ <em>N</em> ≤ 300,000)이 주어진다. 이는 1번부터 <em>N</em>번까지의 번호가 붙은 <em>N</em>개의 역이 있음을 의미한다.</p>

<p>이후 <em>N</em>-1 개의 줄에 걸쳐 서로 인접한 지하철역의 정보가 주어진다. 각 줄에 두 정수 <em>a</em>, <em>b</em>(1 ≤ <em>a</em>, <em>b</em> ≤ <em>N</em>, <em>a</em> ≠ <em>b</em>)가 주어지며, 이는 <em>a</em>번 역과 <em>b</em>번 역이 서로 인접해 있음을 의미한다. 주어지는 정보는 트리 구조임이 보장된다.</p>

<p>그 다음 줄에 직원들이 사는 지하철역의 수 <em>M</em>(1 ≤ <em>M</em> ≤ <em>N</em>)이 주어진다. 그 다음 줄에 <em>M</em>개의 서로 다른 지하철역의 번호가 공백을 사이에 두고 주어진다.</p>

<p>그 다음 줄에 사무실을 옮기려는 후보 지하철역의 수 <em>K</em>(1 ≤ <em>K</em> ≤ <em>N</em>)가 주어진다. 그 다음 줄에 <em>K</em>개의 서로 다른 지하철역의 번호가 공백을 사이에 두고 주어진다.</p>

### 출력 

 <p>첫 번째 줄에 모든 사무실 후보에 대한 모든 직원의 출근 경로 길이의 제곱을 모두 합한 값을 998,244,353으로 나눈 나머지를 출력한다.</p>

