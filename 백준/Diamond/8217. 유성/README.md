# [Diamond IV] 유성 - 8217 

[문제 링크](https://www.acmicpc.net/problem/8217) 

### 성능 요약

메모리: 59892 KB, 시간: 4948 ms

### 분류

이분 탐색, 자료 구조, 병렬 이분 탐색, 세그먼트 트리

### 제출 일자

2025년 3월 7일 15:30:49

### 문제 설명

<p>최근 '백준 우주 연합(BIU)'은 어떤 은하계 근처에서 새로운 행성 하나를 발견했다. 그 행성은 유성우가 많이 내려 사람이 살기엔 적절치 못한 곳이었으나, 유성우에 관한 연구 대상으로는 아주 좋은 곳으로 밝혀졌다.</p>

<p>BIU 회원국은 이미 그 행성 가까이에 우주정거장을 세웠다. 이 우주 정거장의 목적은 유성우의 운석 샘플을 채취하는 것이다. BIU 연합 최고 지도 사령관인 백준은 행성 궤도를 M개의 구역으로 나누고 1부터 M까지 순서대로 번호를 부여했다. (<em><u>행성 궤도는 원 궤도이므로 1번 구역과 M번 구역은 서로 인접해 있다.</u></em>) 각 구역은 N개의 BIU회원국들이 서로 적당히 나누어 가졌다.</p>

<p>각 BIU 회원국들은 모으고자 하는 운석 샘플의 목표치를 정했다. 당신의 임무는 유성우 예보를 바탕으로 각 나라들이 언제 샘플 채취를 완료할 수 있는지 말해주는 것이다.</p>

### 입력 

 <p>첫째 줄에 두 정수 N, M (1 ≤ N, M ≤ 300,000)이 주어진다. N은 BIU연합의 <strong>회원국</strong> 개수고, M은 행성 궤도의 <strong>구역</strong> 개수이다.</p>

<p>둘째 줄에는 M개의 정수 o<sub>i</sub> (1 ≤ o<sub>i</sub> ≤ N)가 주어진다. o<sub>i</sub>는 i번째 구역을 소유하고 있는<strong> BIU연합의 회원국 번호</strong>를 나타낸다.</p>

<p>세 번째 줄에는 N개의 정수 p<sub>j</sub> (1 ≤ p<sub>j</sub> ≤ 10<sup>9</sup>)가 주어진다. p<sub>j</sub>는 j번째 BIU회원국이 <strong>목표치로 정한 운석 샘플 수량</strong>을 나타낸다.</p>

<p>네 번째 줄에는 정수 Q (1 ≤ Q ≤ 300,000)가 주어진다. Q는 <strong>유성우 예보의 수</strong>를 나타낸다.</p>

<p>다음 Q개의 줄에는 예측된 유성우의 개수가 날짜 순서로 표시된다. 각 u번째 줄은 세 가지 정수 l<sub>u</sub>, r<sub>u</sub>, a<sub>u</sub>로 구성되는데, l<sub>u </sub>≤ r<sub>u</sub>인 경우 구역 l<sub>u</sub>,l<sub>u</sub>+1,…,r<sub>u</sub>에 a<sub>u</sub>개의 운석이 내리고, l<sub>u</sub>>r<sub>u</sub>인 경우 구역 l<sub>u</sub>,l<sub>u</sub>+1,…,m,1,…,r<sub>u</sub>에 각 구역당 a<sub>u</sub>개의 운석이 내린다는 뜻이다. (정수 a<sub>u</sub>의 범위는 1 ≤ a<sub>u</sub> ≤ 10<sup>9 </sup>이고, 여기서 u는 유성우 예보 시작 후 u번째 날을 의미한다.)</p>

### 출력 

 <p>회원국별로 샘플조사를 끝마칠 수 있는 최소 일 수 w<sub>j</sub>를 회원국 번호 순서대로 한 줄에 하나씩 출력한다. 끝마치는 날에는 최소한 p<sub>j</sub>개의 운석 샘플을 가지고 있어야 하며, 유성우 예보 기간 안에 운석 샘플을 다 채우지 못 할 경우 NIE(폴란드어로 NO를 의미)를 출력한다.</p>

