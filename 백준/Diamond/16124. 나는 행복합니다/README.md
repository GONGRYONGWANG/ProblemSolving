# [Diamond IV] 나는 행복합니다 - 16124 

[문제 링크](https://www.acmicpc.net/problem/16124) 

### 성능 요약

메모리: 404072 KB, 시간: 1252 ms

### 분류

자료 구조, 느리게 갱신되는 세그먼트 트리, 세그먼트 트리

### 제출 일자

2025년 3월 7일 02:01:33

### 문제 설명

<p>한국 프로야구단 이글스의 열렬한 팬인 아인따는 올해는 분명 이글스의 가을 야구를 볼 수 있을 거라는 희망에 부풀어 있다. 그의 바람대로 올해 이글스가 포스트시즌에 진출한다면 드디어 10자리의 비밀번호를 끊을 수 있게 된다!</p>

<p>한국 프로야구에서 비밀번호란 어떤 팀의 연도별 순위를 나열한 문자열을 말하는데, 오랜 기간 동안 포스트시즌에 진출하지 못한 팀들의 비밀번호는 놀림감이 되곤 한다. 아인따가 응원하는 이글스의 비밀번호는 5886899678이고, 그 외에도 트윈스의 6668587667, 자이언츠의 8888577 등이 유명하다. 한국 프로야구 리그는 10개의 팀으로 구성되어 있기 때문에 1위부터 10위까지 순위가 매겨진다. 이때 10위를 기록한 해는 비밀번호에 0으로 표기한다.</p>

<p>현실 세계의 이글스는 고작 10자리의 비밀번호를 찍고 있지만, 이글스가 100만 자리의 비밀번호를 찍고 있는 미래를 상상하는 것은 그다지 어렵지 않다. 미래의 아인따는 모든 것에서 해탈해서 특별한 능력을 쓸 수 있게 되었다. 아인따는 어떤 기간 동안 이글스가 <em>A</em>등을 기록한 모든 해의 경기 내용을 조작해서 이글스를 <em>B</em>등으로 바꿀 수 있다. 이때 순위가 너무 부자연스러우면 다른 팀의 팬들에게 의심을 살 수 있기 때문에, 능력을 쓰는 중간중간에 어떤 기간의 비밀번호가 얼마나 자연스러운지를 자신만의 방법으로 확인한다.</p>

<p>미래의 이글스의 비밀번호와 아인따가 비밀번호를 조작하는 과정이 주어질 때, 이에 따라 비밀번호를 조작하는 프로그램을 작성해 보자.</p>

### 입력 

 <p>첫 줄에 이글스의 비밀번호를 의미하는 문자열 <em>S</em>가 주어진다. 문자열은 숫자로만 이루어져 있으며, 문자열의 길이는 1 이상 10<sup>6</sup> 이하이다.</p>

<p>두 번째 줄에 아인따가 비밀번호를 조작하면서 취한 행동의 수를 의미하는 정수 <em>Q</em>(1 ≤ <em>Q</em> ≤ 100,000)가 주어진다.</p>

<p>세 번째 줄부터 <em>Q</em>개의 줄에 걸쳐 각 줄에 아인따의 행동이 한 줄에 하나씩 순서대로 주어진다. 아인따의 행동은 다음과 같은 두 가지 형식이 있다.</p>

<ul>
	<li><code>1</code> <em>i</em> <em>j</em> <em>from</em> <em>to</em> (1 ≤ <em>i</em> ≤ <em>j</em> ≤ |<em>S</em>|, <em>from</em>, <em>to</em>는 숫자): 비밀번호의 <em>i</em>번째 위치부터 <em>j</em>번째 위치까지의 범위에 있는 숫자 <em>from</em>을 전부 <em>to</em>로 바꾼다.</li>
	<li><code>2</code> <em>i</em> <em>j</em> (1 ≤ <em>i</em> ≤ <em>j</em> ≤ |<em>S</em>|): 비밀번호의 <em>i</em>번째 위치부터 <em>j</em>번째 위치까지의 숫자를 이어 붙여 하나의 정수로 볼 때, 이 정수를 998,244,353으로 나눈 나머지를 구한다.</li>
</ul>

<p>두 번째 행동이 한 번 이상 주어짐이 보장된다.</p>

### 출력 

 <p>각각의 두 번째 행동에 대한 결과를 순서대로 한 줄에 하나씩 출력한다.</p>

